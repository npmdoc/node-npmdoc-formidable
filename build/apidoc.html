<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/felixge/node-formidable"

    >formidable (v1.1.1)</a>
</h1>
<h4>A node.js module for parsing form data, especially file uploads.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.formidable">module formidable</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.formidable">
            function <span class="apidocSignatureSpan"></span>formidable
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm">
            function <span class="apidocSignatureSpan">formidable.</span>IncomingForm
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.super_">
            function <span class="apidocSignatureSpan">formidable.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.toString">
            function <span class="apidocSignatureSpan">formidable.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">formidable.</span>IncomingForm.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.formidable.IncomingForm">module formidable.IncomingForm</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.IncomingForm">
            function <span class="apidocSignatureSpan">formidable.</span>IncomingForm
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.super_">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.formidable.IncomingForm.prototype">module formidable.IncomingForm.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._error">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_error
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._fileName">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_fileName
            <span class="apidocSignatureSpan">(headerValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._initJSONencoded">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initJSONencoded
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._initMultipart">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initMultipart
            <span class="apidocSignatureSpan">(boundary)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._initOctetStream">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initOctetStream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._initUrlencoded">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initUrlencoded
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._maybeEnd">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_maybeEnd
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._newParser">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_newParser
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._parseContentLength">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_parseContentLength
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._parseContentType">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_parseContentType
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype._uploadPath">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_uploadPath
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.handlePart">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>handlePart
            <span class="apidocSignatureSpan">(part)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.onPart">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>onPart
            <span class="apidocSignatureSpan">(part)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.parse">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>parse
            <span class="apidocSignatureSpan">(req, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.pause">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>pause
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.resume">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>resume
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.write">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>write
            <span class="apidocSignatureSpan">(buffer)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.formidable.IncomingForm.prototype.writeHeaders">
            function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>writeHeaders
            <span class="apidocSignatureSpan">(headers)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.formidable" id="apidoc.module.formidable">module formidable</a></h1>


    <h2>
        <a href="#apidoc.element.formidable.formidable" id="apidoc.element.formidable.formidable">
        function <span class="apidocSignatureSpan"></span>formidable
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IncomingForm(opts) {
  if (!(this instanceof IncomingForm)) return new IncomingForm(opts);
  EventEmitter.call(this);

  opts=opts||{};

  this.error = null;
  this.ended = false;

  this.maxFields = opts.maxFields || 1000;
  this.maxFieldsSize = opts.maxFieldsSize || 2 * 1024 * 1024;
  this.keepExtensions = opts.keepExtensions || false;
  this.uploadDir = opts.uploadDir || (os.tmpdir &#x26;&#x26; os.tmpdir()) || os.tmpDir();
  this.encoding = opts.encoding || &#x27;utf-8&#x27;;
  this.headers = null;
  this.type = null;
  this.hash = opts.hash || false;
  this.multiples = opts.multiples || false;

  this.bytesReceived = null;
  this.bytesExpected = null;

  this._parser = null;
  this._flushing = 0;
  this._fieldsSize = 0;
  this.openedFiles = [];

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm" id="apidoc.element.formidable.IncomingForm">
        function <span class="apidocSignatureSpan">formidable.</span>IncomingForm
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IncomingForm(opts) {
  if (!(this instanceof IncomingForm)) return new IncomingForm(opts);
  EventEmitter.call(this);

  opts=opts||{};

  this.error = null;
  this.ended = false;

  this.maxFields = opts.maxFields || 1000;
  this.maxFieldsSize = opts.maxFieldsSize || 2 * 1024 * 1024;
  this.keepExtensions = opts.keepExtensions || false;
  this.uploadDir = opts.uploadDir || (os.tmpdir &#x26;&#x26; os.tmpdir()) || os.tmpDir();
  this.encoding = opts.encoding || &#x27;utf-8&#x27;;
  this.headers = null;
  this.type = null;
  this.hash = opts.hash || false;
  this.multiples = opts.multiples || false;

  this.bytesReceived = null;
  this.bytesExpected = null;

  this._parser = null;
  this._flushing = 0;
  this._fieldsSize = 0;
  this.openedFiles = [];

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var formidable = require(&#x27;formidable&#x27;),
http = require(&#x27;http&#x27;),
util = require(&#x27;util&#x27;);

http.createServer(function(req, res) {
  if (req.url == &#x27;/upload&#x27; &#x26;&#x26; req.method.toLowerCase() == &#x27;post&#x27;) {
// parse a file upload
var form = new formidable.<span class="apidocCodeKeywordSpan">IncomingForm</span>();

form.parse(req, function(err, fields, files) {
  res.writeHead(200, {&#x27;content-type&#x27;: &#x27;text/plain&#x27;});
  res.write(&#x27;received upload:\n\n&#x27;);
  res.end(util.inspect({fields: fields, files: files}));
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.super_" id="apidoc.element.formidable.super_">
        function <span class="apidocSignatureSpan">formidable.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.toString" id="apidoc.element.formidable.toString">
        function <span class="apidocSignatureSpan">formidable.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    return toString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.formidable.IncomingForm" id="apidoc.module.formidable.IncomingForm">module formidable.IncomingForm</a></h1>


    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.IncomingForm" id="apidoc.element.formidable.IncomingForm.IncomingForm">
        function <span class="apidocSignatureSpan">formidable.</span>IncomingForm
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IncomingForm(opts) {
  if (!(this instanceof IncomingForm)) return new IncomingForm(opts);
  EventEmitter.call(this);

  opts=opts||{};

  this.error = null;
  this.ended = false;

  this.maxFields = opts.maxFields || 1000;
  this.maxFieldsSize = opts.maxFieldsSize || 2 * 1024 * 1024;
  this.keepExtensions = opts.keepExtensions || false;
  this.uploadDir = opts.uploadDir || (os.tmpdir &#x26;&#x26; os.tmpdir()) || os.tmpDir();
  this.encoding = opts.encoding || &#x27;utf-8&#x27;;
  this.headers = null;
  this.type = null;
  this.hash = opts.hash || false;
  this.multiples = opts.multiples || false;

  this.bytesReceived = null;
  this.bytesExpected = null;

  this._parser = null;
  this._flushing = 0;
  this._fieldsSize = 0;
  this.openedFiles = [];

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var formidable = require(&#x27;formidable&#x27;),
http = require(&#x27;http&#x27;),
util = require(&#x27;util&#x27;);

http.createServer(function(req, res) {
  if (req.url == &#x27;/upload&#x27; &#x26;&#x26; req.method.toLowerCase() == &#x27;post&#x27;) {
// parse a file upload
var form = new formidable.<span class="apidocCodeKeywordSpan">IncomingForm</span>();

form.parse(req, function(err, fields, files) {
  res.writeHead(200, {&#x27;content-type&#x27;: &#x27;text/plain&#x27;});
  res.write(&#x27;received upload:\n\n&#x27;);
  res.end(util.inspect({fields: fields, files: files}));
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.super_" id="apidoc.element.formidable.IncomingForm.super_">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.formidable.IncomingForm.prototype" id="apidoc.module.formidable.IncomingForm.prototype">module formidable.IncomingForm.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._error" id="apidoc.element.formidable.IncomingForm.prototype._error">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_error
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_error = function (err) {
  if (this.error || this.ended) {
    return;
  }

  this.error = err;
  this.emit(&#x27;error&#x27;, err);

  if (Array.isArray(this.openedFiles)) {
    this.openedFiles.forEach(function(file) {
      file._writeStream.destroy();
      setTimeout(fs.unlink, 0, file.path, function(error) { });
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._fileName" id="apidoc.element.formidable.IncomingForm.prototype._fileName">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_fileName
        <span class="apidocSignatureSpan">(headerValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_fileName = function (headerValue) {
  // matches either a quoted-string or a token (RFC 2616 section 19.5.1)
  var m = headerValue.match(/\bfilename=(&#x22;(.*?)&#x22;|([^\(\)&#x3c;&#x3e;@,;:\\&#x22;\/\[\]\?=\{\}\s\t/]+))($|;\s)/i);
  if (!m) return;

  var match = m[2] || m[3] || &#x27;&#x27;;
  var filename = match.substr(match.lastIndexOf(&#x27;\\&#x27;) + 1);
  filename = filename.replace(/%22/g, &#x27;&#x22;&#x27;);
  filename = filename.replace(/&#x26;#([\d]{4});/g, function(m, code) {
    return String.fromCharCode(code);
  });
  return filename;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._initJSONencoded" id="apidoc.element.formidable.IncomingForm.prototype._initJSONencoded">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initJSONencoded
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initJSONencoded = function () {
  this.type = &#x27;json&#x27;;

  var parser = new JSONParser(this)
    , self = this;

  if (this.bytesExpected) {
    parser.initWithLength(this.bytesExpected);
  }

  parser.onField = function(key, val) {
    self.emit(&#x27;field&#x27;, key, val);
  };

  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._initMultipart" id="apidoc.element.formidable.IncomingForm.prototype._initMultipart">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initMultipart
        <span class="apidocSignatureSpan">(boundary)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initMultipart = function (boundary) {
  this.type = &#x27;multipart&#x27;;

  var parser = new MultipartParser(),
      self = this,
      headerField,
      headerValue,
      part;

  parser.initWithBoundary(boundary);

  parser.onPartBegin = function() {
    part = new Stream();
    part.readable = true;
    part.headers = {};
    part.name = null;
    part.filename = null;
    part.mime = null;

    part.transferEncoding = &#x27;binary&#x27;;
    part.transferBuffer = &#x27;&#x27;;

    headerField = &#x27;&#x27;;
    headerValue = &#x27;&#x27;;
  };

  parser.onHeaderField = function(b, start, end) {
    headerField += b.toString(self.encoding, start, end);
  };

  parser.onHeaderValue = function(b, start, end) {
    headerValue += b.toString(self.encoding, start, end);
  };

  parser.onHeaderEnd = function() {
    headerField = headerField.toLowerCase();
    part.headers[headerField] = headerValue;

    // matches either a quoted-string or a token (RFC 2616 section 19.5.1)
    var m = headerValue.match(/\bname=(&#x22;([^&#x22;]*)&#x22;|([^\(\)&#x3c;&#x3e;@,;:\\&#x22;\/\[\]\?=\{\}\s\t/]+))/i);
    if (headerField == &#x27;content-disposition&#x27;) {
      if (m) {
        part.name = m[2] || m[3] || &#x27;&#x27;;
      }

      part.filename = self._fileName(headerValue);
    } else if (headerField == &#x27;content-type&#x27;) {
      part.mime = headerValue;
    } else if (headerField == &#x27;content-transfer-encoding&#x27;) {
      part.transferEncoding = headerValue.toLowerCase();
    }

    headerField = &#x27;&#x27;;
    headerValue = &#x27;&#x27;;
  };

  parser.onHeadersEnd = function() {
    switch(part.transferEncoding){
      case &#x27;binary&#x27;:
      case &#x27;7bit&#x27;:
      case &#x27;8bit&#x27;:
      parser.onPartData = function(b, start, end) {
        part.emit(&#x27;data&#x27;, b.slice(start, end));
      };

      parser.onPartEnd = function() {
        part.emit(&#x27;end&#x27;);
      };
      break;

      case &#x27;base64&#x27;:
      parser.onPartData = function(b, start, end) {
        part.transferBuffer += b.slice(start, end).toString(&#x27;ascii&#x27;);

<span class="apidocCodeCommentSpan">        /*
        four bytes (chars) in base64 converts to three bytes in binary
        encoding. So we should always work with a number of bytes that
        can be divided by 4, it will result in a number of buytes that
        can be divided vy 3.
        */
</span>        var offset = parseInt(part.transferBuffer.length / 4, 10) * 4;
        part.emit(&#x27;data&#x27;, new Buffer(part.transferBuffer.substring(0, offset), &#x27;base64&#x27;));
        part.transferBuffer = part.transferBuffer.substring(offset);
      };

      parser.onPartEnd = function() {
        part.emit(&#x27;data&#x27;, new Buffer(part.transferBuffer, &#x27;base64&#x27;));
        part.emit(&#x27;end&#x27;);
      };
      break;

      default:
      return self._error(new Error(&#x27;unknown transfer-encoding&#x27;));
    }

    self.onPart(part);
  };


  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._initOctetStream" id="apidoc.element.formidable.IncomingForm.prototype._initOctetStream">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initOctetStream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initOctetStream = function () {
  this.type = &#x27;octet-stream&#x27;;
  var filename = this.headers[&#x27;x-file-name&#x27;];
  var mime = this.headers[&#x27;content-type&#x27;];

  var file = new File({
    path: this._uploadPath(filename),
    name: filename,
    type: mime
  });

  this.emit(&#x27;fileBegin&#x27;, filename, file);
  file.open();

  this._flushing++;

  var self = this;

  self._parser = new OctetParser();

  //Keep track of writes that haven&#x27;t finished so we don&#x27;t emit the file before it&#x27;s done being written
  var outstandingWrites = 0;

  self._parser.on(&#x27;data&#x27;, function(buffer){
    self.pause();
    outstandingWrites++;

    file.write(buffer, function() {
      outstandingWrites--;
      self.resume();

      if(self.ended){
        self._parser.emit(&#x27;doneWritingFile&#x27;);
      }
    });
  });

  self._parser.on(&#x27;end&#x27;, function(){
    self._flushing--;
    self.ended = true;

    var done = function(){
      file.end(function() {
        self.emit(&#x27;file&#x27;, &#x27;file&#x27;, file);
        self._maybeEnd();
      });
    };

    if(outstandingWrites === 0){
      done();
    } else {
      self._parser.once(&#x27;doneWritingFile&#x27;, done);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._initUrlencoded" id="apidoc.element.formidable.IncomingForm.prototype._initUrlencoded">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_initUrlencoded
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initUrlencoded = function () {
  this.type = &#x27;urlencoded&#x27;;

  var parser = new QuerystringParser(this.maxFields)
    , self = this;

  parser.onField = function(key, val) {
    self.emit(&#x27;field&#x27;, key, val);
  };

  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._maybeEnd" id="apidoc.element.formidable.IncomingForm.prototype._maybeEnd">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_maybeEnd
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_maybeEnd = function () {
  if (!this.ended || this._flushing || this.error) {
    return;
  }

  this.emit(&#x27;end&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._newParser" id="apidoc.element.formidable.IncomingForm.prototype._newParser">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_newParser
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_newParser = function () {
  return new MultipartParser();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._parseContentLength" id="apidoc.element.formidable.IncomingForm.prototype._parseContentLength">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_parseContentLength
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseContentLength = function () {
  this.bytesReceived = 0;
  if (this.headers[&#x27;content-length&#x27;]) {
    this.bytesExpected = parseInt(this.headers[&#x27;content-length&#x27;], 10);
  } else if (this.headers[&#x27;transfer-encoding&#x27;] === undefined) {
    this.bytesExpected = 0;
  }

  if (this.bytesExpected !== null) {
    this.emit(&#x27;progress&#x27;, this.bytesReceived, this.bytesExpected);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._parseContentType" id="apidoc.element.formidable.IncomingForm.prototype._parseContentType">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_parseContentType
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseContentType = function () {
  if (this.bytesExpected === 0) {
    this._parser = dummyParser(this);
    return;
  }

  if (!this.headers[&#x27;content-type&#x27;]) {
    this._error(new Error(&#x27;bad content-type header, no content-type&#x27;));
    return;
  }

  if (this.headers[&#x27;content-type&#x27;].match(/octet-stream/i)) {
    this._initOctetStream();
    return;
  }

  if (this.headers[&#x27;content-type&#x27;].match(/urlencoded/i)) {
    this._initUrlencoded();
    return;
  }

  if (this.headers[&#x27;content-type&#x27;].match(/multipart/i)) {
    var m = this.headers[&#x27;content-type&#x27;].match(/boundary=(?:&#x22;([^&#x22;]+)&#x22;|([^;]+))/i);
    if (m) {
      this._initMultipart(m[1] || m[2]);
    } else {
      this._error(new Error(&#x27;bad content-type header, no multipart boundary&#x27;));
    }
    return;
  }

  if (this.headers[&#x27;content-type&#x27;].match(/json/i)) {
    this._initJSONencoded();
    return;
  }

  this._error(new Error(&#x27;bad content-type header, unknown content-type: &#x27;+this.headers[&#x27;content-type&#x27;]));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype._uploadPath" id="apidoc.element.formidable.IncomingForm.prototype._uploadPath">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>_uploadPath
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_uploadPath = function (filename) {
  var buf = crypto.randomBytes(16);
  var name = &#x27;upload_&#x27; + buf.toString(&#x27;hex&#x27;);

  if (this.keepExtensions) {
    var ext = path.extname(filename);
    ext     = ext.replace(/(\.[a-z0-9]+).*/i, &#x27;$1&#x27;);

    name += ext;
  }

  return path.join(this.uploadDir, name);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.handlePart" id="apidoc.element.formidable.IncomingForm.prototype.handlePart">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>handlePart
        <span class="apidocSignatureSpan">(part)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handlePart = function (part) {
  var self = this;

  if (part.filename === undefined) {
    var value = &#x27;&#x27;
      , decoder = new StringDecoder(this.encoding);

    part.on(&#x27;data&#x27;, function(buffer) {
      self._fieldsSize += buffer.length;
      if (self._fieldsSize &#x3e; self.maxFieldsSize) {
        self._error(new Error(&#x27;maxFieldsSize exceeded, received &#x27;+self._fieldsSize+&#x27; bytes of field data&#x27;));
        return;
      }
      value += decoder.write(buffer);
    });

    part.on(&#x27;end&#x27;, function() {
      self.emit(&#x27;field&#x27;, part.name, value);
    });
    return;
  }

  this._flushing++;

  var file = new File({
    path: this._uploadPath(part.filename),
    name: part.filename,
    type: part.mime,
    hash: self.hash
  });

  this.emit(&#x27;fileBegin&#x27;, part.name, file);

  file.open();
  this.openedFiles.push(file);

  part.on(&#x27;data&#x27;, function(buffer) {
    if (buffer.length == 0) {
      return;
    }
    self.pause();
    file.write(buffer, function() {
      self.resume();
    });
  });

  part.on(&#x27;end&#x27;, function() {
    file.end(function() {
      self._flushing--;
      self.emit(&#x27;file&#x27;, part.name, file);
      self._maybeEnd();
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
```
If you want to use formidable to only handle certain parts for you, you can do so:
```javascript
form.onPart = function(part) {
  if (!part.filename) {
    // let formidable handle all non-file parts
    form.<span class="apidocCodeKeywordSpan">handlePart</span>(part);
  }
}
```
Check the code in this method for further inspiration.


### Formidable.File
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.onPart" id="apidoc.element.formidable.IncomingForm.prototype.onPart">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>onPart
        <span class="apidocSignatureSpan">(part)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPart = function (part) {
  // this method can be overwritten by the user
  this.handlePart(part);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


```javascript
form.parse(req, function(err, fields, files) {
// ...
});

form.<span class="apidocCodeKeywordSpan">onPart</span>(part);
```
You may overwrite this method if you are interested in directly accessing the multipart stream. Doing so will disable any `&#x27
;field&#x27;` / `&#x27;file&#x27;` events  processing which would occur otherwise, making you fully responsible for handling the
 processing.

```javascript
form.onPart = function(part) {
part.addListener(&#x27;data&#x27;, function() {
  // ...
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.parse" id="apidoc.element.formidable.IncomingForm.prototype.parse">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>parse
        <span class="apidocSignatureSpan">(req, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (req, cb) {
  this.pause = function() {
    try {
      req.pause();
    } catch (err) {
      // the stream was destroyed
      if (!this.ended) {
        // before it was completed, crash &#x26; burn
        this._error(err);
      }
      return false;
    }
    return true;
  };

  this.resume = function() {
    try {
      req.resume();
    } catch (err) {
      // the stream was destroyed
      if (!this.ended) {
        // before it was completed, crash &#x26; burn
        this._error(err);
      }
      return false;
    }

    return true;
  };

  // Setup callback first, so we don&#x27;t miss anything from data events emitted
  // immediately.
  if (cb) {
    var fields = {}, files = {};
    this
      .on(&#x27;field&#x27;, function(name, value) {
        fields[name] = value;
      })
      .on(&#x27;file&#x27;, function(name, file) {
        if (this.multiples) {
          if (files[name]) {
            if (!Array.isArray(files[name])) {
              files[name] = [files[name]];
            }
            files[name].push(file);
          } else {
            files[name] = file;
          }
        } else {
          files[name] = file;
        }
      })
      .on(&#x27;error&#x27;, function(err) {
        cb(err, fields, files);
      })
      .on(&#x27;end&#x27;, function() {
        cb(null, fields, files);
      });
  }

  // Parse headers and setup the parser, ready to start listening for data.
  this.writeHeaders(req.headers);

  // Start listening for data.
  var self = this;
  req
    .on(&#x27;error&#x27;, function(err) {
      self._error(err);
    })
    .on(&#x27;aborted&#x27;, function() {
      self.emit(&#x27;aborted&#x27;);
      self._error(new Error(&#x27;Request aborted&#x27;));
    })
    .on(&#x27;data&#x27;, function(buffer) {
      self.write(buffer);
    })
    .on(&#x27;end&#x27;, function() {
      if (self.error) {
        return;
      }

      var err = self._parser.end();
      if (err) {
        self._error(err);
      }
    });

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  util = require(&#x27;util&#x27;);

http.createServer(function(req, res) {
if (req.url == &#x27;/upload&#x27; &#x26;&#x26; req.method.toLowerCase() == &#x27;post&#x27;) {
  // parse a file upload
  var form = new formidable.IncomingForm();

  form.<span class="apidocCodeKeywordSpan">parse</span>(req, function(err, fields, files) {
    res.writeHead(200, {&#x27;content-type&#x27;: &#x27;text/plain&#x27;});
    res.write(&#x27;received upload:\n\n&#x27;);
    res.end(util.inspect({fields: fields, files: files}));
  });

  return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.pause" id="apidoc.element.formidable.IncomingForm.prototype.pause">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>pause
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pause = function () {
  // this does nothing, unless overwritten in IncomingForm.parse
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.resume" id="apidoc.element.formidable.IncomingForm.prototype.resume">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>resume
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resume = function () {
  // this does nothing, unless overwritten in IncomingForm.parse
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
form.on(&#x27;file&#x27;, function(name, file) {
});
```

#### &#x27;error&#x27;

Emitted when there is an error processing the incoming form. A request that experiences an error is automatically paused, you will
 have to manually call `request.<span class="apidocCodeKeywordSpan">resume</span>()` if you want the request to continue firing `&#
x27;data&#x27;` events.

```javascript
form.on(&#x27;error&#x27;, function(err) {
});
```

#### &#x27;aborted&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.write" id="apidoc.element.formidable.IncomingForm.prototype.write">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>write
        <span class="apidocSignatureSpan">(buffer)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (buffer) {
  if (this.error) {
    return;
  }
  if (!this._parser) {
    this._error(new Error(&#x27;uninitialized parser&#x27;));
    return;
  }

  this.bytesReceived += buffer.length;
  this.emit(&#x27;progress&#x27;, this.bytesReceived, this.bytesExpected);

  var bytesParsed = this._parser.write(buffer);
  if (bytesParsed !== buffer.length) {
    this._error(new Error(&#x27;parser error, &#x27;+bytesParsed+&#x27; of &#x27;+buffer.length+&#x27; bytes parsed&#x27;));
  }

  return bytesParsed;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
http.createServer(function(req, res) {
if (req.url == &#x27;/upload&#x27; &#x26;&#x26; req.method.toLowerCase() == &#x27;post&#x27;) {
  // parse a file upload
  var form = new formidable.IncomingForm();

  form.parse(req, function(err, fields, files) {
    res.writeHead(200, {&#x27;content-type&#x27;: &#x27;text/plain&#x27;});
    res.<span class="apidocCodeKeywordSpan">write</span>(&#x27;received upload:\n\n&#x27;);
    res.end(util.inspect({fields: fields, files: files}));
  });

  return;
}

// show a file upload form
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.formidable.IncomingForm.prototype.writeHeaders" id="apidoc.element.formidable.IncomingForm.prototype.writeHeaders">
        function <span class="apidocSignatureSpan">formidable.IncomingForm.prototype.</span>writeHeaders
        <span class="apidocSignatureSpan">(headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeHeaders = function (headers) {
  this.headers = headers;
  this._parseContentLength();
  this._parseContentType();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
